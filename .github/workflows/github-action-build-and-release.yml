jobs:
  build_release:
    name: build_release
    runs-on: self-hosted
    steps:
    - continue-on-error: true
      name: checkout
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
    - continue-on-error: true
      name: Setup JDK
      uses: actions/setup-java@v4
      with:
        distribution: zulu
        java-version: '17'
    - continue-on-error: true
      name: Build
      run: "./gradlew bootJar\necho \"artifactPath=$(pwd)\" >> $GITHUB_ENV\nversion=$(cat\
        \ VERSION) \ntag=${GITHUB_REF_NAME}\necho \"version=$version\" >> $GITHUB_ENV\n\
        echo \"tag=$tag\" >> $GITHUB_ENV\ncp build/libs/tabby.jar .\nzip -r tabby.zip\
        \ . -x \"build/*\" \".github/*\" \"cyphers/*\" \".git/*\" \"doc/*\" \"gradle/*\"\
        \ \"src/*\" \".gitignore\" \"README.md\" \"*gradle*\"\nrm tabby.jar\n"
    - continue-on-error: true
      run: echo version is ${{ env.version }}
    - continue-on-error: true
      run: echo tag is ${{ env.tag }}
    - continue-on-error: true
      env:
        GITHUB_TOKEN: ${{ github.token }}
      id: create_release
      name: release
      uses: actions/create-release@v1
      with:
        body: RELEASE:${{ env.version }}. Generated By Github Actions.
        draft: false
        prerelease: false
        release_name: ${{ env.tag }}
        tag_name: ${{ env.tag }}
    - continue-on-error: true
      env:
        GITHUB_TOKEN: ${{ github.token }}
      name: upload release
      uses: actions/upload-release-asset@v1
      with:
        asset_content_type: application/zip
        asset_name: tabby.zip
        asset_path: ${{ env.artifactPath }}/tabby.zip
        upload_url: ${{ steps.create_release.outputs.upload_url }}
name: build-release
on:
  repository_dispatch:
    types: trigger-ga___github-action-build-and-release.yml
run-name: Build And Release Tabby
